

http://www.tianshouzhi.com/api/tutorials/netty/344

只有在可读字节数>=4的情况下，我们才进行解码，即读取一个int，并添加到List中。

在可读字节数小于4的情况下，我们并没有做任何处理，假设剩余可读字节数为3，不足以构成1个int。那么父类ByteToMessageDecoder发现这次解码List中的元素没有变化，则会对in中的剩余3个字节进行缓存，等待下1个字节的到来，之后再回到调用ToIntegerDecoder的decode方法。

另外，细心的读者可能注意到了，在`ToIntegerDecoder`的decode方法中，每次最多只读取一个1个int。如果ByteBuf中的字节数很多，例如为16，那么可以构成4个int，而这里只读取了1个int，那么剩余12字节怎么办？这个其实不用担心，ByteToMessageDecoder再每次回调子类的decode方法之后，都会判断输入的ByteBuf中是否还有剩余字节可读，如果还有，会再次回调子类的decode方法，直到某个回调decode方法List中的元素个数没有变化时才停止，元素个数没有变化，实际上意味着子类已经没有办法从剩余的字节中读取一个有效报文。

由于存在剩余可读字节时，ByteToMessageDecoder会自动再次回调子类decode方法，因此笔者建议在实现ByteToMessageDecoder时，decode方法每次只解析一个有效报文即可，没有必要一次全部解析出来。





如果List<Object> out 里面装了多个， 流程是怎么样的。

String 之前到底是否需要一个ByteToMessageDecoder



第一个并不一定是要 ByteToMessage， 只要类型匹配即可。





1.如果 发的多了，则多次走Handler链路

2.如果List中加入多个，则后面的那个channelRead0/decode方法执行多次。 双重循环（遍历）









ReplyingDecoder

LineBasedFrameDecoder 使用\n或者 \r\n来分隔



DelimiterBasedFrameDecoder 自定义分隔符作为消息的分隔符



HttpObjectDecoder



LengthFieldBasedFrameDecoder



```
 FixedLengthFrameDecoder   定长解码器
```

ZlibEncoder  ZlibDecoder









